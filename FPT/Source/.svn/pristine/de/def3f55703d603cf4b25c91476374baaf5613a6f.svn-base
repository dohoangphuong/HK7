    @model IEnumerable<CSS.Models.AgreementStatu>

@{
    ViewBag.Title = "AgreementStatics";
}

<script type="text/javascript">
    $(document).ready(function () {
        $("#viewAgreement").click(function (e) {
            var selected = $("#recentTable input[type='radio']:checked");
            if (selected.length != 1) {
                alert("Please select 1 agreement.");
                $("form").submit(function () {
                    return false;
                })
            }
            else {
                return true;
            }
        })
    });
</script>

<div class="content-wrap">
    <div class="centre">
        <h3 class="blue-text">Coporate Sales Solution</h3>
        <p class="gray-text">Recent activity</p>
    </div>

    <ul>
        @foreach (var item in Model)
        {
            <li>
                <label class="label-stt">@Html.ActionLink(@item.AgreementStatus, "SearchAgreement", new { statusId = @item.StatusId})</label>
                <label class="label-count">@item.Agreements.Where(x=> (x.CreatedBy == @User.Identity.Name) && (x.LastUpdatedDate != null? ((DateTime.Now - (DateTime)x.LastUpdatedDate).TotalHours <= 24) : false)).Count()</label>
            </li>
        }
    </ul>
    <br />
</div>

@using (Html.BeginForm()) {
@Html.AntiForgeryToken()
@Html.ValidationSummary(true)
    <p class="gray-text">Recently Accessed Agreement</p>
    <table class="table table-striped" id ="recentTable">
        <thead>
            <tr class="info">
                <th>Customer Name</th>
                <th>Customer Code</th>
                <th>Post code</th>
                <th>CSM</th>
                <th>Start Date</th>
                <th>End Date</th>
                <th>Agreement</th>
                <th>Variant</th>
                <th>Status</th>
                <th>Select</th>
            </tr>
        </thead>
        <tbody>
            @foreach (CSS.Models.Agreement item in ViewBag.recentAgreement)
            {
                <tr>
                    @if(@item.RFONumbers.Count > 0)
                    {
                        <td>@item.RFONumbers.First().Company.Name</td>
                        <td>@item.RFONumbers.First().RFONumber1</td>
                        <td>@item.RFONumbers.First().PostCode</td>
                    }
                    else
                    {
                        <td></td>
                        <td></td>
                        <td></td>
                    }
                    <td>???</td>
                    <td>@(item.StartDate != null? item.StartDate.Value.ToShortDateString() : null)</td>
                    <td>@(item.EndDate != null? item.EndDate.Value.ToShortDateString() : null)</td>
                    <td>@item.AgreementNumber</td>
                    <td>@item.VariantNumber</td>
                    <td>@item.AgreementStatu.AgreementStatus</td>
                    <td>@Html.RadioButton("Select", @item.AgreementNumber + "/" + @item.VariantNumber,true)</td>
                </tr>
            }
        </tbody>
    </table>
    <div class="action-panel">
        <button type="submit" id ="viewAgreement">View Agreement</button>
    </div>
}
